language: java
sudo: false # run on travis's container infrastructure

jdk:
    - oraclejdk8

# TODO msebek: consolidate this logic into one script, then have both builders call it.
install:
    - curl -L https://services.gradle.org/distributions/gradle-2.7-bin.zip -o gradle-2.7-bin.zip
    - unzip gradle-2.7-bin.zip
    - export BUGGY_ROOT=`pwd`
    - export GRADLE_HOME=$BUGGY_ROOT/gradle-2.7
    - export GRADLE_BIN=$GRADLE_HOME/bin
    - export PATH=$PATH:$GRADLE_BIN

before_script:
  - git clone https://github.com/Itseez/opencv.git
  - cd opencv 
  - git checkout 3.0.0
  - mkdir build
  - cd build
  - cmake ..
  - make -j4
  - sudo make -j4 install
  - mvn install:install-file -Dfile=/usr/local/share/OpenCV/java/opencv-300.jar -DgroupId=opencv -DartifactId=opencv -Dversion=3.0.0 -Dpackaging=jar
  - cd ../..

script:
    - echo 'the end is nigh, silly drivers'
    - ls; pwd; java -version
    - echo $PATH
    - echo $HOME
    - echo $BUGGY_ROOT
    - (cd real_time/surface_src/java_src/Alice && $GRADLE_BIN/gradle build)
